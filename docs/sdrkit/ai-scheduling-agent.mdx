---
title: "AI Scheduling Agent"
sidebarTitle: "AI Scheduler"
icon: "calendar"
description: "This project demonstrates how to use Composio to create a scheduling agent."
---

## Overview
The AI Scheduling Agent is an automated assistant that reads your emails, schedules meetings in Google Calendar, and sends confirmation emails - all without manual intervention. It streamlines the meeting scheduling process by handling the back-and-forth communication automatically.

## Getting Started  

<Tabs>
<Tab title="Python">
<Steps>
<Step title="Installation">
```bash install dependencies
pip install composio-llamaindex python-dotenv
```
</Step>

<Step title="Connecting to tools and models">
```bash connect to required tools
composio add peopledatalabs
composio add googlesheets

export OPENAI_API_KEY="<your-openai-api-key>"
```
</Step>

<Step title="Importing the required libraries">
```python import required libraries
from composio_llamaindex import ComposioToolSet, App, Action
from llama_index.core.agent import FunctionCallingAgentWorker
from llama_index.core.llms import ChatMessage
from llama_index.llms.openai import OpenAI
from dotenv import load_dotenv

load_dotenv()
```
</Step>

<Step title="Initializing the Tools and the LLM">
```python initialize toolset and llm
toolset = ComposioToolSet(api_key="")
tools = toolset.get_tools(apps=[App.PEOPLEDATALABS, App.GOOGLESHEETS])

llm = OpenAI(model="gpt-4o")
```
</Step>

<Step title="Setting up Function Calling Worker">
```python setup function calling worker
spreadsheetid = '14T4e0j1XsWjriQYeFMgkM2ihyvLAplPqB9q8hytytcw'
# Set up prefix messages for the agent
prefix_messages = [
    ChatMessage(
        role="system",
        content=(
            f"""
            You are a lead research agent. Based on user input, find 10 relevant leads using people data labs.
            After finding the leads, create a Google Sheet with the details for the lead description, and spreadsheet ID: ${spreadsheetid}.
            Print the list of people and their details and the link to the google sheet."""
        ),
    )
]

agent = FunctionCallingAgentWorker(
    tools=tools,
    llm=llm,
    prefix_messages=prefix_messages,
    max_function_calls=10,
    allow_parallel_tool_calls=False,
    verbose=True,
).as_agent()
```
</Step>

<Step title="Executing the Agent">
```python run the agent
lead_description = 'Senior frontend developers in San Francisco'
user_input = f"Create a lead list based on the description: {lead_description}"
response = agent.chat(user_input)
```
</Step>

<Step title='Final Code'>
```python final code
from composio_llamaindex import ComposioToolSet, App, Action
from llama_index.core.agent import FunctionCallingAgentWorker
from llama_index.core.llms import ChatMessage
from llama_index.llms.openai import OpenAI
from dotenv import load_dotenv

load_dotenv()
toolset = ComposioToolSet(api_key="")
tools = toolset.get_tools(apps=[App.PEOPLEDATALABS, App.GOOGLESHEETS])

llm = OpenAI(model="gpt-4o")

spreadsheetid = '14T4e0j1XsWjriQYeFMgkM2ihyvLAplPqB9q8hytytcw'
# Set up prefix messages for the agent
prefix_messages = [
    ChatMessage(
        role="system",
        content=(
            f"""
            You are a lead research agent. Based on user input, find 10 relevant leads using people data labs.
            After finding the leads, create a Google Sheet with the details for the lead description, and spreadsheet ID: ${spreadsheetid}.
            Print the list of people and their details and the link to the google sheet."""
        ),
    )
]

agent = FunctionCallingAgentWorker(
    tools=tools,
    llm=llm,
    prefix_messages=prefix_messages,
    max_function_calls=10,
    allow_parallel_tool_calls=False,
    verbose=True,
).as_agent()

lead_description = 'Senior frontend developers in San Francisco'
user_input = f"Create a lead list based on the description: {lead_description}"
response = agent.chat(user_input)
```
</Step>
</Steps>
</Tab>

<Tab title="Javascript">
<Steps>
<Step title="Installation">
```bash install dependencies
npm install composio-core openai dotenv @ai-sdk/openai ai dotenv
```
</Step>

<Step title="Connecting to tools and models">
```bash connect to required tools
composio add googlecalendar gmail

export OPENAI_API_KEY="<your-openai-api-key>"
export COMPOSIO_API_KEY="<your-composio-api-key>"
```
</Step>

<Step title="Importing the required libraries">
```javascript import required libraries
import { openai } from "@ai-sdk/openai";
import { VercelAIToolSet } from "composio-core";
import dotenv from "dotenv";
import { generateText } from "ai";
dotenv.config();
```
</Step>

<Step title="Initializing the Toolset">
```javascript initialize toolset and llm
const toolset = new VercelAIToolSet({
  apiKey: process.env.COMPOSIO_API_KEY,
});
```
</Step>

<Step title="Subscribing to the trigger, configuring the agent">
```javascript setup the ai agent
await toolset.client.triggers.subscribe(async (data) => {
    console.log("trigger received", data);
    const payload = data.payload;
    const message = payload.messageText;
    const sender = payload.sender;
    const threadId = payload.threadId;
    const entity_id = 'default';
    
      // Setup entity and ensure connection
    const entity = await toolset.client.getEntity(entity_id);
    
      // Retrieve tools for the specified app
      const tools = await toolset.getTools({ apps: ["googlecalendar","gmail"] }, entity.id);
      
      // Generate text using the model and tools
      const output = await generateText({
        model: openai("gpt-4o"),
        streamText: false,
        tools: tools,
        prompt: `
                This is a message from ${sender}: ${message}
                Threadid:${threadId}
                This is the date: ${new Date().toISOString()}
                You are a scheduling agent, Read the email received and understand the content.
                After understanding the content, create a calendar event with the details.
                Then reply to the email with the calendar event details. If thread id is not provided, create a draft email.
                `, 
        maxToolRoundtrips: 5,
      });
    
      console.log("ðŸŽ‰Output from agent: ", output.text);

});
```
</Step>

<Step title='Final Code'>
```javascript final code
import { ChatOpenAI } from "@langchain/openai";
import { createOpenAIFunctionsAgent, AgentExecutor } from "langchain/agents";
import { pull } from "langchain/hub";
import dotenv from 'dotenv';
import { LangchainToolSet } from "composio-core";

dotenv.config();

const llm = new ChatOpenAI({
    model: "gpt-4-turbo",
    apiKey: process.env.OPENAI_API_KEY,
});

const toolset = new LangchainToolSet({
    apiKey: process.env.COMPOSIO_API_KEY,
});

const tools = await toolset.getTools({
    apps: ["tavily"]
});

const prompt = await pull("hwchase17/openai-functions-agent");

const additional = `You are a market research agent that finds niche ideas that can be built and marketed. 
        Your users are primarily indie hackers who want to build something new and are looking for ideas. The input will 
        be a domain or a category and your job is to research extensively and find ideas that can be marketed.
        Also write the content to market a tool built with this idea. It should be very very specific and not too long.`;

const agent = await createOpenAIFunctionsAgent({
    llm,
    tools,
    prompt,
});

const agentExecutor = new AgentExecutor({
    agent,
    tools,
    verbose: true,
});
const domain = 'AI SaaS'
const result = await agentExecutor.invoke({
    input: additional + 'This is the domain:' + domain
});
console.log('ðŸŽ‰Output from agent: ', result.output);

```
</Step>
</Steps>
</Tab>
</Tabs>